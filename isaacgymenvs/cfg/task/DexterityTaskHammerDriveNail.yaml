# See schema in factory_schema_config_task.py for descriptions of common parameters.

defaults:
    - _self_
    # - /factory_schema_config_task

name: DexterityTaskHammerDriveNail
physics_engine: ${..physics_engine}
full_experiment_name: ${..experiment}


# needed for headless VR
enableCameraSensors: True

sim:
    use_gpu_pipeline: ${eq:${...pipeline},"gpu"}
    up_axis: "z"
    dt: 0.033333333 # required, but overridden in DexterityBase.yaml
    gravity: [0.0, 0.0, -9.81]  # required, but overridden in base DexterityBase.yaml

    disable_gravity: False

env:
    numEnvs: ${resolve_default:16384,${...num_envs}}
    numObservations: 0  # overwritten depending on observations
    observations: ['previous_action', 'ik_body_pos', 'ik_body_quat', 'ik_body_demo_pos', 'ik_body_demo_quat', 'hand_bodies_pos', 'hand_bodies_quat', 'hand_bodies_demo_pos', 'hand_bodies_demo_quat', 'hammer_pos', 'hammer_quat', 'nail_pos']
    numActions: 0  # overwritten depending on robot configuration

ablation: '' # 'disable_grasp_pose_generalization', 'disable_pre_grasp_pose', 'disable_demo_guidance'

randomize:
    move_to_pre_grasp_pose: True
    hammer_pos_drop: [ -0.05, 0.1, 0.1 ]  # position from which hammer is dropped
    hammer_pos_drop_noise: [ 0.01, 0.01, 0.0 ]  # noise on hammer drop position
    hammer_quat_drop: [-0.707, 0, 0, 0.707]
    num_hammer_drop_steps: 150  # number of steps to drop hammers

    nail_pos_xy_initial: [ 0.45, 0.0 ]  # initial xy position of the hammer
    nail_pos_xy_initial_noise: [ 0.01, 0.01 ]  # noise on initial hammer position

    ik_body_pos_initial: [0.0, 0.0, 0.5]  # initial position of ik_body
    ik_body_pos_noise: [0.0, 0.0, 0.0]  # noise on ik_body position
    ik_body_euler_initial: [0.0, 0.0, 0.0]  # initial rotation of ik_body
    ik_body_euler_noise: [0.0, 0.0, 0.0]  # noise on ik_body rotation
    num_ik_body_initial_move_steps: 250  # number of steps to reach initial pose

rl:
    reward:
        action_penalty: 0.001  # scale on action penalty
        hand_bodies_dist_penalty: 0.000005
        hand_bodies_reached_bonus: 0.25
        ik_body_pose_success_bonus: 0.125
        liftoff_reward: 0.05  # scale on object lift-off progress reward
        nail_dist_penalty: 0.25
        nail_depth_reward: 100.0
        success_bonus: 100.0

    lift_off_height: 0.05
    target_nail_depth: -0.075
    max_episode_length: 300
